<{extend name="./public/index"/}>
<{block name="content"}>
<div  class=" content-panel ">
    <!--导航栏-->
    <!--<{include file="./public/navbar"/}>-->
    <link rel="stylesheet" href="__CSS__/mall_default_comment.css" type="text/css"/>
    <link rel="stylesheet" href="__CSS__/plugin/magnifier.css" type="text/css"/>
    <div data-ng-controller="goodsCtrl" class="goods-detail-panel wp_100">
        <div class="goods-picture wp_40  pull-left">
            <!-- 大图begin -->
            <div id="preview" class="main-pic wp_100">
                 <span class="jqzoom"><img jqimg="<{$goods.pic.0.pic}>" src="<{$goods.pic.0.pic}>" /></span> 
            </div>
            <!-- 大图end -->
            <!-- 缩略图begin -->
            <div class="spec-scroll"> <a class=" prev">&lt;</a> <a class=" next">&gt;</a>
                <div class="items">
                    <ul>
                        <{volist name="goods.pic" id="vo" empty="暂时没有数据"}>
                            <li><img bimg="<{$vo.pic}>" src="<{$vo.pic}>" onmousemove="preview(this);"></li>
                        <{/volist}>
                    </ul>
                </div>
            </div>
            <!-- 缩略图end -->

        </div>


        <div class="goods-detail wp_60 pull-left">
            <h4><{$goods.name}> </h4>
            <p class="goods-desc" title="<{$goods.description}>"><{$goods.description}></p>
            <div class="goods-price  wp_100">
                <p>
                    
                    
                    <{if $goods.promotion.type == 1}>
                    <span class="item-title">促销价：</span>
                    <span class="font-color-sub_main">¥</span>
                    <span class=" price" title="折扣后价格" ng-bind="{{real_price|number:2}}"></span>
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <s >六儿价:<span ng-bind="{{price}}"></span></s>

                    <{else}>
                    <span class="item-title">六 儿 价：</span>
                    <span class="font-color-sub_main">¥</span>
                    <span class=" price" ng-bind="{{price}}"></span>
                    <{/if}>
                    
                </p>
                
                <p>
                    <{if $goods.promotion > 0}>
                        <span class="item-title">促 销：</span>
                        <span class="goods-promotion " title="<{$goods.promotion.description}>">
                        <{$goods.promotion.title}>
                        </span>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <{/if}>
                    <span class="item-title">购买可获得：</span>
                    购买可获得 <{$goods.bait}> 鱼饵 + <{$goods.point}> 积分
                    
                </p>
                
                <p>
                    <span class="item-title">来 源：</span>
                    <{if $goods.userid == 0}>
                        六儿官方
                    <{else}>
                        来源不明
                    <{/if}>
                </p>
            </div>
            
            <p class="goods-info">
                <span class="item-title">重量：</span>
                <{$goods.weight}>kg
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
           
                <{if $goods.free_shipping ==1}>
                    免运费 
                <{/if}>
            </p>
            
            <ul>
                <li><span class="item-title">选择规格：</span></li>
                <{volist name="$goods.spec" id="vo"}>
                    <li class=" default-spec-li" ng-class="{choseSpec: <{$vo.id}>==isChose}" ng-click="specSelect(<{$vo.id}>);"><{$vo.spec}></li>
                <{/volist}>
            </ul>

            
            <div class="amount-number wp_100">
                <p style="line-height: 45px;"><span class="item-title">库存：</span><{$goods.amount}>
                <!--<i class="deal-num-fa fa fa-plus-square-o"></i>-->
                <input id="buy-number" ng-model="buy_number" title="填写购买数量"/>
                <!--<i class="deal-num-fa fa fa-minus-square-o"></i>-->

                </p>
                
            </div>
            <div class="goods-buy wp_100">
                <!--立即购买-->
                <!--<a href="/index/sale/buy/id/<{$goods.id}>/spec/{{specValue}}/num/{{buy_number}}">
                    <div>立即购买</div>
                </a>-->

                <a href="/index/cart/add/id/<{$goods.id}>/spec/{{specValue}}/num/{{buy_number}}" title="加入购物车">
                    <button class="submit-btn ">加入购物车</button>
                </a>

                <!--<a href="/index/sale/collect/id/<{$goods.id}>">
                    <div>收藏</div>
                </a>-->
                
            </div>
            <{if $goods.service}>
                <p class="goods-service">
                    <span class="item-title">尊享服务：</span>
                    <{volist name="goods.service" id="vo"}>
                    <{$vo.title}>
                    <{/volist}>
                </p>
            <{/if}>
            
        </div>


        <!--更多内容-->
        
        <div class="more-info wp_100 pull-left">
            <div class="more-info-navbar wp_100 ">
                <ul  >
                    <li  >
                        <a href="javascript: void(0);" ng-click="barSelect(0);">商品详情</a>
                    </li>
                    <li class="li-split">/</li>
                    <li   >
                        <a href="javascript: void(0);"  ng-click="barSelect(1);">规格与包装</a>
                    </li>
                    <li class="li-split" >/</li>
                    <li  >
                        <a href="javascript: void(0);"  ng-click="barSelect(2);">售后保障</a>
                    </li>
                    <li class="li-split" >/</li>
                    <li  >
                        <a href="javascript: void(0);"  ng-click="barSelect(3);">商品评论</a>
                    </li>
                </ul>
            </div>
            <div class="more-info-detail wp_100 khidden" ng-class="{kshow: 0==choseBar}">
                <{$goods.detail | htmlspecialchars_decode}>
            </div>
            <div class="more-info-detail wp_100 khidden" ng-class="{kshow: 1==choseBar}">
                规格与包装
            </div>
            <div class="more-info-detail wp_100 khidden" ng-class="{kshow: 2==choseBar}">
                售后保障
            </div>
            <div class="more-info-detail wp_100 khidden" ng-class="{kshow: 3==choseBar}">
                <div class="goods-title wp_100 h45">
                    商品评价
                </div>
                <div class="goods-com">
                    <div class="o_h fz_18">
                        <div class="comment-percent w120 h100">
                            <strong class="percent-tit">好评度</strong>
                            <div class="percent-con">
                                100<span>%</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="goods-main h30">
                    <ul>
                        <li>
                            <a href="javascript: void(0);" ng-click="barSelected(0);">全部评论</a>
                        </li>
                        <li class="li-split">/</li>
                        <li>
                            <a href="javascript: void(0);" ng-click="barSelected(1);">好评</a>
                        </li>
                        <li class="li-split" >/</li>
                        <li>
                            <a href="javascript: void(0);" ng-click="barSelected(2);">中评</a>
                        </li>
                        <li class="li-split" >/</li>
                        <li>
                            <a href="javascript: void(0);" ng-click="barSelected(3);">差评</a>
                        </li>
                    </ul>
                </div>
                <div style="clear:both;"></div>
                <!-- 全部评论 -->
                <div class="more-info-detail wp_100 hp_100 khidden" ng-class="{kshow: 0==choseBare}">
                    <div class="comment-item">
                        <{volist name="comment" id="vo"}>
                        <{if $goods.id == $vo.gid}>
                        <div class="user-column w150">
                            <div class="wp_20 f_l">
								<img src="<{$vo.headimgurl}>" class="w30 h30 o_h head-img" />
								<span class="liu"><{$vo.nickname}></span><br />
								<!--<span class="ba">PLUS会员</span>-->
							</div>
							<div class="wp_80 f_r" >
                                    <{if $vo.comment_star == 1}>
                                    <span><img src="__STATIC__/images/comment/onestar.png"></span>
                                    <{/if}>
                                    <{if $vo.comment_star == 2}>
                                    <span><img src="__STATIC__/images/comment/twostar.png"></span>
                                    <{/if}>
                                    <{if $vo.comment_star == 3}>
                                    <span><img src="__STATIC__/images/comment/threestar.png"></span>
                                    <{/if}>
                                    <{if $vo.comment_star == 4}>
                                    <span><img src="__STATIC__/images/comment/fourstar.png"></span>
                                    <{/if}>
                                    <{if $vo.comment_star == 5}>
                                    <span><img src="__STATIC__/images/comment/fivestar.png"></span>
                                    <{/if}>
                                <div><{$vo.comment}></div>
                                <!-- 遍历评论显示的图片 -->
								<!-- <div>
									<img src="" class="w50 h50"/>
								</div> -->
								<div>
									<div class="f_l" >
                                        <span class="ba"><{$vo.spec}></span>&nbsp;&nbsp;&nbsp;&nbsp; 
                                        <span class="ba"><{$vo.addtime|date="Y-m-d H:i",###}></span>
									</div>
									<div class="f_r w100" >
                                        <!-- 点赞 -->
                                        <div class="praise">
                                            <span id="praise"><img src="__STATIC__/images/comment/zan.png" id="praise-img" /></span>
                                            <span id="praise-txt"><{$vo.agree}></span>
                                            <span id="add-num"><em>+1</em></span>
                                        </div>
									</div>
								</div>
							</div>
                        </div>
                        <{/if}>
						<{/volist}>
						
                    </div>   
                </div>
                <!-- 好评 -->
                <div class="more-info-detail wp_100 khidden" ng-class="{kshow: 1==choseBare}">
                    <div class="comment-item">
                        <{volist name="comment" id="vo"}>
                        <{if $goods.id == $vo.gid}>
                        <{if $vo.comment_star>=4}>
                        <div class="user-column w150">
                            <div class="wp_20 f_l">
								<img src="<{$vo.headimgurl}>" class="w30 h30 o_h head-img" />
								<span class="liu"><{$vo.nickname}></span><br />
								<span class="ba">PLUS会员</span>
							</div>
							<div class="wp_80 f_r" >
                                    <{if $vo.comment_star == 4}>
                                    <span><img src="__STATIC__/images/comment/fourstar.png"></span>
                                    <{/if}>
                                    <{if $vo.comment_star == 5}>
                                    <span><img src="__STATIC__/images/comment/fivestar.png"></span>
                                    <{/if}>
                                <div><{$vo.comment}></div>

								<div>
									<div class="f_l" >
                                        <span class="ba"><{$vo.spec}></span>&nbsp;&nbsp;&nbsp;&nbsp; 
                                        <span class="ba"><{$vo.addtime|date="Y-m-d H:i",###}></span>
									</div>
									<div class="f_r w100" >
                                        <!-- 点赞 -->
                                        <div class="praise">
                                            <span id="praise"><img src="__STATIC__/images/comment/zan.png" id="praise-img" /></span>
                                            <span id="praise-txt"><{$vo.agree}></span>
                                            <span id="add-num"><em>+1</em></span>
                                        </div>
                                    </div>
								</div>
							</div>
                        </div>
                        <{/if}>
                        <{/if}>
						<{/volist}>
						
                    </div>   
                </div>
                <!-- 中评 -->
                <div class="more-info-detail wp_100 khidden" ng-class="{kshow: 2==choseBare}">
                    <div class="comment-item">
                        <{volist name="comment" id="vo"}>
                        <{if $goods.id == $vo.gid}>
                        <{if $vo.comment_star>=2 && $vo.comment_star<4}>
                        <div class="user-column w150">
                            <div class="wp_20 f_l">
								<img src="<{$vo.headimgurl}>" class="w30 h30 o_h head-img" />
								<span class="liu"><{$vo.nickname}></span><br />
								<span class="ba">PLUS会员</span>
							</div>
							<div class="wp_80 f_r" >
                                <{if $vo.comment_star == 2}>
                                <span><img src="__STATIC__/images/comment/twostar.png"></span>
                                <{/if}>
                                <{if $vo.comment_star == 3}>
                                <span><img src="__STATIC__/images/comment/threestar.png"></span>
                                <{/if}>
                                <{if $vo.comment_star == 4}>
                                <span><img src="__STATIC__/images/comment/fourstar.png"></span>
                                <{/if}>
                                <div><{$vo.comment}></div>
                                <!-- 遍历评论显示的图片 -->
								<!-- <div>
									<img src="" class="w50 h50"/>
								</div> -->
								<div>
									<div class="f_l" >
                                        <span class="ba"><{$vo.spec}></span>&nbsp;&nbsp;&nbsp;&nbsp; 
                                        <span class="ba"><{$vo.addtime|date="Y-m-d H:i",###}></span>
									</div>
									<div class="f_r w100" >
                                        <!-- 点赞 -->
                                        <div class="praise">
                                            <span id="praise"><img src="__STATIC__/images/comment/zan.png" id="praise-img" /></span>
                                            <span id="praise-txt"><{$vo.agree}></span>
                                            <span id="add-num"><em>+1</em></span>
                                        </div>
                                    </div>
								</div>
							</div>
                        </div>
                        <{/if}>
                        <{/if}>
						<{/volist}>
						
                    </div>   
                </div>
                <!-- 差评 -->
                <div class="more-info-detail wp_100 khidden" ng-class="{kshow: 3==choseBare}">
                    <div class="comment-item">
                        <{volist name="comment" id="vo"}>
                        <{if $goods.id == $vo.gid}>
                        <{if $vo.comment_star==1}>
                        <div class="user-column w150">
                            <div class="wp_20 f_l">
								<img src="<{$vo.headimgurl}>" class="w30 h30 o_h head-img" />
								<span class="liu"><{$vo.nickname}></span><br />
								<span class="ba">PLUS会员</span>
							</div>
							<div class="wp_80 f_r" >
                                    <{if $vo.comment_star == 1}>
                                    <span><img src="__STATIC__/images/comment/onestar.png"></span>
                                    <{/if}>
                                <div><{$vo.comment}></div>
                                <!-- 遍历评论显示的图片 -->
								<!-- <div>
									<img src="" class="w50 h50"/>
								</div> -->
								<div>
									<div class="f_l" >
                                        <span class="ba"><{$vo.spec}></span>&nbsp;&nbsp;&nbsp;&nbsp; 
                                        <span class="ba"><{$vo.addtime|date="Y-m-d H:i",###}></span>
									</div>
									<div class="f_r w100" >
                                        <!-- 点赞 -->
                                        <div class="praise">
                                            <span id="praise"><img src="__STATIC__/images/comment/zan.png" id="praise-img" /></span>
                                            <span id="praise-txt"><{$vo.agree}></span>
                                            <span id="add-num"><em>+1</em></span>
                                        </div>
                                    </div>
								</div>
							</div>
                        </div>
                        <{/if}>
                        <{/if}>
						<{/volist}>
						
                    </div>   
                </div>
            </div>
            
        </div>
    </div>
</div>

<script>
    
    app.controller('goodsCtrl', function($scope) {
        $scope.price = <{$goods.price}>;
        <{if $goods.promotion.type==1}>
            $scope.real_price = <{$goods.price}>*<{$goods.promotion.percent}>/100;
        <{/if}>
        $scope.buy_number = 1; //购买数量初始化
        
        //商品详情
        $scope.choseBar = 0;
        $scope.barSelect = function($id){
            $scope.choseBar = $id;
        }

        $scope.choseBare = 0;
        $scope.barSelected = function($id){
            $scope.choseBare = $id;
        }

        $scope.specSelect = function($id) {
            $scope.specValue = $id; 
            $scope.isChose = $id;
        }
    });


</script>
<script>
	/* @author:Romey
	 * 动态点赞
	 * 此效果包含css3，部分浏览器不兼容（如：IE10以下的版本）
	*/
	$(function(){
		$("#praise").click(function(){
			var praise_img = $("#praise-img");
			var text_box = $("#add-num");
			var praise_txt = $("#praise-txt");
			var num=parseInt(praise_txt.text());
			if(praise_img.attr("src") == ("__STATIC__/images/comment/yizan.png")){
				$(this).html("<img src='__STATIC__/images/comment/zan.png' id='praise-img' class='animation' />");
				praise_txt.removeClass("hover");
				text_box.show().html("<em class='add-animation'>-1</em>");
				$(".add-animation").removeClass("hover");
				num -=1;
				praise_txt.text(num)
			}else{
				$(this).html("<img src='__STATIC__/images/comment/yizan.png' id='praise-img' class='animation' />");
				praise_txt.addClass("hover");
				text_box.show().html("<em class='add-animation'>+1</em>");
				$(".add-animation").addClass("hover");
				num +=1;
				praise_txt.text(num)
            }
            var agree = praise_txt.html();
            $.ajax({
                type: "get",
                url:  "/index/goods/zan",
                data: {agree: agree},
                success:function(res){
                },
                error:function(e){
                }
            });
		});
    })
    
    $("#dianji").click(function(){
        $("#dianzan").removeClass("khidden").addClass("kshow");
    });
</script>

<script src="__JS__/plugin/magnifier/jquery.jqzoom.js"></script>
<script src="__JS__/plugin/magnifier/magnifier.js"></script>
<{/block}>